<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Detail - Parasol Insurance</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div id="page-content">
        <a href="/claims.html" class="back-link">&lsaquo; Back to claims</a>

        <div class="claim-header" id="claim-header">
            <div class="claim-id">
                <svg viewBox="0 0 24 24" width="20" height="20"><path fill="#555" d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z"/></svg>
                <span id="detail-claim-id"></span>
            </div>
            <span class="status-badge" id="detail-status"></span>
            <div class="header-detail">
                <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                <span id="detail-client"></span>
            </div>
            <div class="header-detail">
                <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>
                <span id="detail-policy"></span>
            </div>
            <button class="btn-edit">Edit</button>
        </div>

        <div class="detail-layout">
            <div class="detail-main">
                <div class="tabs">
                    <button class="tab active" data-tab="summary">Summary</button>
                    <button class="tab" data-tab="insurance">Insurance</button>
                    <button class="tab" data-tab="damages">Damages</button>
                    <button class="tab" data-tab="witnesses">Witnesses</button>
                    <button class="tab" data-tab="documents">Documents</button>
                    <button class="tab" data-tab="comments">Comments</button>
                </div>

                <div class="tab-content" id="tab-summary">
                    <div class="detail-section">
                        <div class="detail-icon">&#128197;</div>
                        <div>
                            <div class="detail-label">Date and time</div>
                            <div class="detail-value" id="detail-date"></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-icon">&#128205;</div>
                        <div>
                            <div class="detail-label">Location of event</div>
                            <div class="detail-value" id="detail-location"></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-icon">&#128196;</div>
                        <div>
                            <div class="detail-label">Summary</div>
                            <div class="detail-value" id="detail-summary"></div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="tab-insurance" style="display:none">
                    <div class="detail-section">
                        <div class="detail-icon">&#128179;</div>
                        <div>
                            <div class="detail-label">Estimated Amount</div>
                            <div class="detail-value" id="detail-amount"></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-icon">&#128100;</div>
                        <div>
                            <div class="detail-label">Assigned Adjuster</div>
                            <div class="detail-value" id="detail-adjuster"></div>
                        </div>
                    </div>
                    <div class="detail-section">
                        <div class="detail-icon">&#128231;</div>
                        <div>
                            <div class="detail-label">Client Contact</div>
                            <div class="detail-value" id="detail-contact"></div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="tab-damages" style="display:none">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">&#128663;</div>
                        <h2>Damage Assessment</h2>
                        <p>Detailed damage reports and assessments will appear here.</p>
                    </div>
                </div>

                <div class="tab-content" id="tab-witnesses" style="display:none">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">&#128101;</div>
                        <h2>Witness Statements</h2>
                        <p>Witness information and statements will appear here.</p>
                    </div>
                </div>

                <div class="tab-content" id="tab-documents" style="display:none">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">&#128194;</div>
                        <h2>Documents</h2>
                        <p>Uploaded documents, photos, and police reports will appear here.</p>
                    </div>
                </div>

                <div class="tab-content" id="tab-comments" style="display:none">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">&#128172;</div>
                        <h2>Comments</h2>
                        <p>Internal notes and comments from adjusters will appear here.</p>
                    </div>
                </div>
            </div>

            <div class="detail-sidebar">
                <div class="image-panel">
                    <div class="image-main" id="image-main">
                        <div class="image-placeholder">
                            <span class="placeholder-icon">&#128247;</span>
                            <div>Loading photos...</div>
                        </div>
                    </div>
                    <div class="image-thumbnails" id="image-thumbnails"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/layout.js"></script>
    <script>
        initLayout('claims');

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(tc => tc.style.display = 'none');
                tab.classList.add('active');
                document.getElementById('tab-' + tab.dataset.tab).style.display = 'block';
            });
        });

        // Load claim data
        const claimId = new URLSearchParams(window.location.search).get('id');
        if (claimId) {
            document.title = claimId + ' - Parasol Insurance';
            fetch('/api/claims/' + claimId)
                .then(r => r.json())
                .then(c => {
                    document.getElementById('detail-claim-id').textContent = c.claimNumber;
                    const statusEl = document.getElementById('detail-status');
                    statusEl.textContent = c.status;
                    statusEl.className = 'status-badge ' + c.status.toLowerCase().replace(/\s+/g, '-');
                    document.getElementById('detail-client').textContent = c.clientName;
                    document.getElementById('detail-policy').textContent = c.policyNumber;
                    document.getElementById('detail-date').textContent = c.dateOfEvent;
                    document.getElementById('detail-location').textContent = c.locationOfEvent;
                    document.getElementById('detail-summary').textContent = c.summary;
                    document.getElementById('detail-amount').textContent = c.estimatedAmount;
                    document.getElementById('detail-adjuster').textContent = c.adjuster;
                    document.getElementById('detail-contact').innerHTML =
                        c.clientPhone + '<br>' + c.clientEmail;

                    // Render images
                    if (c.images && c.images.length > 0) {
                        const mainEl = document.getElementById('image-main');
                        const thumbsEl = document.getElementById('image-thumbnails');
                        mainEl.innerHTML = '<img src="' + c.images[0] + '" alt="Claim evidence photo" style="width:100%;height:100%;object-fit:cover;">';
                        thumbsEl.innerHTML = c.images.map((img, i) =>
                            '<img src="' + img + '" alt="Photo ' + (i+1) + '" class="image-thumb' + (i === 0 ? ' active' : '') + '" data-src="' + img + '">'
                        ).join('');
                        thumbsEl.querySelectorAll('.image-thumb').forEach(thumb => {
                            thumb.addEventListener('click', () => {
                                mainEl.innerHTML = '<img src="' + thumb.dataset.src + '" alt="Claim evidence photo" style="width:100%;height:100%;object-fit:cover;">';
                                thumbsEl.querySelectorAll('.image-thumb').forEach(t => t.classList.remove('active'));
                                thumb.classList.add('active');
                            });
                        });
                    }
                });
        }
    </script>
</body>
</html>
